{"version":3,"file":"static/js/260.a7eb7fe2.chunk.js","mappings":"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","sources":["services/modules/label.js","services/modules/product.js","utils/getTableScroll.js","views/label/style.js","views/label/schema/table.js","views/label/c-cpns/addOrEditDialog/style.js","views/label/c-cpns/ym-upload/index.jsx","views/label/c-cpns/addOrEditDialog/index.jsx","views/label/index.jsx"],"sourcesContent":["import { requestJson, requestMultipart } from '..'\n\n// 获取商品列表\nexport const getLabelList = (data) => {\n  return requestJson.request({\n    method: 'get',\n    url: '/label',\n    data\n  })\n}\n\n// 删除商品\nexport const deleteLabelById = (id) => {\n  return requestJson.request({\n    method: 'delete',\n    url: `/label/${id}`\n  })\n}\n\n// 根据id查询标签\nexport const getProductById = (id) => {\n  return requestJson.request({\n    method: 'get',\n    url: `/label/${id}`\n  })\n}\n\n// 添加标签\nexport const addLabel = (data) => {\n  return requestJson.request({\n    method: 'post',\n    url: '/label/',\n    data\n  })\n}\n\n// 修改标签\nexport const editProduct = (data) => {\n  return requestJson.request({\n    method: 'put',\n    url: '/label/update',\n    data\n  })\n}\n\n// 上传商品banner\nexport const uploadProductBanner = (data) => {\n  return requestMultipart.request({\n    method: 'post',\n    url: '/upload/product_banner',\n    data\n  })\n}\n\n// 删除图片\nexport const deleteImgByName = (data) => {\n  return requestJson.request({\n    method: 'post',\n    url: `/upload/deleteStaticImg`,\n    data\n  })\n}\n","import { requestJson, requestMultipart } from '..'\n\n// 获取商品列表\nexport const getProductList = (data) => {\n  return requestJson.request({\n    method: 'post',\n    url: '/product/list',\n    data\n  })\n}\n\n// 根据id查询商品\nexport const getProductById = (id) => {\n  return requestJson.request({\n    method: 'get',\n    url: `/product/list/${id}`\n  })\n}\n\n// 添加商品\nexport const addProduct = (data) => {\n  return requestJson.request({\n    method: 'post',\n    url: '/product/create',\n    data\n  })\n}\n\n// 修改商品\nexport const editProduct = (data) => {\n  return requestJson.request({\n    method: 'put',\n    url: '/product/update',\n    data\n  })\n}\n\n// 上传商品banner\nexport const uploadProductBanner = (data) => {\n  return requestMultipart.request({\n    method: 'post',\n    url: '/upload/product_banner',\n    data\n  })\n}\n\n// 删除商品\nexport const deleteProductById = (id) => {\n  return requestJson.request({\n    method: 'delete',\n    url: `/product/delete/${id}`\n  })\n}\n\n// 删除图片\nexport const deleteImgByName = (data) => {\n  return requestJson.request({\n    method: 'post',\n    url: `/upload/deleteStaticImg`,\n    data\n  })\n}\n","/**\n * 获取第一个表格的可视化高度\n * @param {*} extraHeight 额外的高度(表格底部的内容高度 Number类型,默认为74)\n * @param {*} id 当前页面中有多个table时需要制定table的id\n */\nexport function getTableScroll({ extraHeight, id } = {}) {\n  if (typeof extraHeight == 'undefined') {\n    //  默认底部分页64 + 边距10\n    extraHeight = 74\n  }\n  let tHeader = null\n  if (id) {\n    tHeader = document.getElementById(id)\n      ? document.getElementById(id).getElementsByClassName('ant-table-thead')[0]\n      : null\n  } else {\n    tHeader = document.getElementsByClassName('ant-table-thead')[0]\n  }\n  //表格内容距离顶部的距离\n  let tHeaderBottom = 0\n  if (tHeader) {\n    tHeaderBottom = tHeader.getBoundingClientRect().bottom\n  }\n  //窗体高度-表格内容顶部的高度-表格内容底部的高度\n  // let height = document.body.clientHeight - tHeaderBottom - extraHeight\n  let height = `calc(100vh - ${tHeaderBottom + extraHeight}px)`\n  return height\n}\n","import styled from 'styled-components'\n\nexport const LabelWrapper = styled.div`\n  height: 100%;\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n  box-sizing: border-box;\n  overflow: hidden;\n  .basic {\n    padding: 16px;\n    background-color: #fff;\n    border-radius: 8px;\n  }\n  .query {\n    margin-bottom: 10px;\n  }\n  .table {\n    flex: 1;\n    overflow: hidden;\n    .actions {\n      margin-bottom: 15px;\n    }\n  }\n`\n","import dayjs from 'dayjs'\nimport { Button, Space, Tooltip, Image, Popconfirm } from 'antd'\n\nfunction getColumns({ handleDelete = () => {}, handleEdit = () => {} } = {}) {\n  const confirm = (record) => {\n    handleDelete(record)\n  }\n  return [\n    // {\n    //   title: 'id',\n    //   dataIndex: 'id',\n    //   align: 'center',\n    //   key: 'id',\n    //   fixed: 'left'\n    // },\n    {\n      title: '标签名',\n      dataIndex: 'name',\n      align: 'center',\n      key: 'name'\n    },\n    {\n      title: '标签icon',\n      dataIndex: 'icon',\n      align: 'center',\n      key: 'icon',\n      render(url) {\n        return <Image width={70} height={50} src={url} />\n      }\n    },\n\n    {\n      title: '操作',\n      key: 'action',\n      render(text, record) {\n        return (\n          <Space size=\"small\">\n            <Button type=\"link\" onClick={() => handleEdit(record)}>\n              编辑\n            </Button>\n\n            <Popconfirm\n              title=\"删除\"\n              description=\"此操作将会永久删除\"\n              onConfirm={(e) => confirm(record, e)}\n              okText=\"确定\"\n              cancelText=\"取消\"\n            >\n              <Button type=\"link\">删除</Button>\n            </Popconfirm>\n          </Space>\n        )\n      }\n    }\n  ]\n}\n\nexport default getColumns\n","import styled from 'styled-components'\n\nexport const AddOrEditDialogWrapper = styled.div``\n","import React, { useEffect, useState } from 'react'\nimport { PlusOutlined } from '@ant-design/icons'\nimport { Modal, Upload } from 'antd'\nimport * as http from '@/services/modules/product'\nconst getBase64 = (file) =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    reader.readAsDataURL(file)\n    reader.onload = () => resolve(reader.result)\n    reader.onerror = (error) => reject(error)\n  })\nconst YmUpload = (props) => {\n  const { setPath, onChange, imgList, maxCount } = props\n\n  const [previewOpen, setPreviewOpen] = useState(false)\n  const [previewImage, setPreviewImage] = useState('')\n  const [previewTitle, setPreviewTitle] = useState('')\n  const [fileList, setFileList] = useState([])\n  const handleCancel = () => setPreviewOpen(false)\n\n  // console.log(imgList, fileList)\n\n  useEffect(() => {\n    if (!imgList) return\n    setFileList(imgList)\n  }, [imgList])\n  //\n  const handlePreview = async (file) => {\n    if (!file.url && !file.preview) {\n      file.preview = await getBase64(file.originFileObj)\n    }\n    setPreviewImage(file.url || file.preview)\n    setPreviewOpen(true)\n    setPreviewTitle(\n      file.name || file.url.substring(file.url.lastIndexOf('/') + 1)\n    )\n  }\n  //\n  const handleChange = ({ file, fileList }) => {\n    console.log(fileList, 'change')\n    setPath(fileList)\n    onChange(fileList)\n    setFileList(fileList)\n  }\n\n  const uploadButton = (\n    <div>\n      <PlusOutlined />\n      <div\n        style={{\n          marginTop: 8\n        }}\n      >\n        Upload\n      </div>\n    </div>\n  )\n  // remove\n  const handleRemove = async (file) => {\n    // await http.deleteImgByName({\n    //   url: file.url\n    // })\n    // console.log(file)\n  }\n\n  //\n  const handleBeforeUpload = () => false\n  return (\n    <>\n      <Upload\n        listType=\"picture-card\"\n        fileList={fileList}\n        onPreview={handlePreview}\n        onChange={handleChange}\n        onRemove={handleRemove}\n        beforeUpload={handleBeforeUpload}\n        maxCount={maxCount ? maxCount : null}\n      >\n        {fileList.length >= 8 ? null : uploadButton}\n      </Upload>\n      <Modal\n        open={previewOpen}\n        title={previewTitle}\n        footer={null}\n        onCancel={handleCancel}\n      >\n        <img\n          alt=\"example\"\n          style={{\n            width: '100%'\n          }}\n          src={previewImage}\n        />\n      </Modal>\n    </>\n  )\n}\nexport default YmUpload\n","import React, { memo, useEffect, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport { InputNumber, Modal, Form, Input } from 'antd'\nimport { AddOrEditDialogWrapper } from './style'\nimport YmUpload from '../ym-upload'\nimport * as http from '@/services/modules/label'\n\nconst AddOrEditDialog = memo((props) => {\n  const { title, type, editId, dialogClose, dialogConfrim } = props\n  const [form] = Form.useForm()\n  const [iconPath, setIconPath] = useState([])\n  const [iconFileList, setIconFileList] = useState([])\n\n  const handleUploadImage = async (files) => {\n    const formData = new FormData()\n    files.forEach((itme) => {\n      formData.append('img', itme.originFileObj)\n    })\n    const { data } = await http.uploadProductBanner(formData)\n    return data\n  }\n\n  const getImgPath = async (changePath, originPath) => {\n    let path = []\n    if (changePath.length) {\n      // 筛选新增的图片\n      let changeList = changePath.filter((item) => !item.url)\n      // 筛选原有的图片\n      let originList = changePath.filter((item) => item.url)\n      // 这层判断的含义是 如果原本就有两个图片删除了一个那么changePath中也是有内容的只不过changeList是无内容的\n      if (changeList.length) {\n        let list = await handleUploadImage(changeList)\n        path = list.map((item) => ({ url: item }))\n      }\n      // 将新增图片获取的地址和老图片的地址合并\n      path = [...path, ...originList]\n    } else {\n      path = originPath\n    }\n\n    return path.map((item) => item.url)\n  }\n\n  const handleFinish = async (v) => {\n    if (type === 'add') {\n      console.log(v)\n      const paths = await handleUploadImage(iconPath)\n      const data = {\n        ...v,\n        icon: paths.join(',')\n      }\n      dialogConfrim(data, 'add')\n    } else {\n      let icon = await getImgPath(iconPath, iconFileList)\n\n      const data = {\n        ...v,\n        id: editId,\n        icon: icon.join(',')\n      }\n\n      dialogConfrim(data, 'edit')\n    }\n  }\n\n  const mapUrlToObjUrl = (list) => {\n    if (!list) return []\n    return list.map((item) => ({\n      url: item\n    }))\n  }\n\n  const fetchData = async () => {\n    if (type === 'edit' && editId) {\n      const { code, data } = await http.getProductById(editId)\n      if (code === 0) {\n        form.setFieldsValue({ ...data })\n        setIconFileList(mapUrlToObjUrl(data?.icon?.split(',')))\n      }\n    }\n  }\n\n  useEffect(() => {\n    fetchData()\n  }, [])\n\n  return (\n    <AddOrEditDialogWrapper>\n      <Modal\n        title={title}\n        open={true}\n        onCancel={dialogClose}\n        onOk={() => form.submit()}\n      >\n        <Form\n          autoComplete=\"off\"\n          form={form}\n          labelCol={{ span: 6 }}\n          onFinish={handleFinish}\n        >\n          <Form.Item\n            label=\"标签名称\"\n            name=\"name\"\n            validateTrigger=\"onBlur\"\n            rules={[\n              {\n                required: true,\n                message: '请输入必填项'\n              }\n            ]}\n          >\n            <Input placeholder=\"请输入\" />\n          </Form.Item>\n\n          <Form.Item\n            rules={[\n              {\n                required: true,\n                message: '必填项'\n              }\n            ]}\n            label=\"标签icon\"\n            name=\"icon\"\n          >\n            <YmUpload\n              setPath={setIconPath}\n              imgList={iconFileList}\n              maxCount={1}\n            ></YmUpload>\n          </Form.Item>\n        </Form>\n      </Modal>\n    </AddOrEditDialogWrapper>\n  )\n})\n\nAddOrEditDialog.propTypes = {\n  title: PropTypes.string\n}\n\nAddOrEditDialog.defaultProps = {\n  title: '新增'\n}\nexport default AddOrEditDialog\n","import React, { memo, useCallback, useEffect, useState } from 'react'\nimport { LabelWrapper } from './style'\nimport { Table, Button } from 'antd'\nimport getColumns from './schema/table'\nimport AddOrEditDialog from './c-cpns/addOrEditDialog'\nimport * as http from '@/services/modules/label'\nimport { getTableScroll } from '@/utils/getTableScroll'\n\nconst Label = memo(() => {\n  const [tableData, setTableData] = useState([])\n  const [visible, setVisible] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const [addOrEdit, setAddOrEdit] = useState('add')\n  const [editId, setEditId] = useState(0)\n  const [scrollY, setScrollY] = useState(0)\n\n  // init data\n  const fetchList = async () => {\n    try {\n      setLoading(true)\n      const { data } = await http.getLabelList()\n      setLoading(false)\n      const tableData = data.map((item) => {\n        item.key = item.id\n        return item\n      })\n      setTableData(tableData)\n    } catch (error) {\n      console.log(error)\n    }\n  }\n\n  useEffect(() => {\n    fetchList()\n    const height = getTableScroll()\n    setScrollY(height)\n  }, [])\n\n  // 新增\n  const showDialog = () => {\n    setAddOrEdit('add')\n    setVisible(true)\n  }\n  const dialogClose = (e) => {\n    setVisible(false)\n  }\n\n  const dialogConfrim = useCallback(async (payload, type) => {\n    console.log(payload)\n    const url = type === 'add' ? 'addLabel' : 'editProduct'\n\n    const { code } = await http[url](payload)\n    if (code === 0) {\n      window.$msg.success('添加成功～')\n      fetchList()\n      setVisible(false)\n    }\n  }, [])\n\n  // 删除\n  const handleDelete = async ({ id }) => {\n    const { code } = await http.deleteLabelById(id)\n    if (code === 0) {\n      window.$msg.success('操作成功～')\n      fetchList()\n    }\n  }\n\n  // 编辑\n  const handleEdit = ({ id }) => {\n    setEditId(id)\n    setAddOrEdit('edit')\n\n    setVisible(true)\n  }\n\n  return (\n    <LabelWrapper>\n      <div className=\"table basic\">\n        <div className=\"actions\">\n          <Button type=\"primary\" onClick={showDialog}>\n            新增\n          </Button>\n        </div>\n        <Table\n          bordered\n          columns={getColumns({ handleDelete, handleEdit })}\n          dataSource={tableData}\n          pagination={false}\n          loading={loading}\n          scroll={{\n            y: scrollY\n          }}\n        />\n      </div>\n      {/* dialog */}\n      {visible && (\n        <AddOrEditDialog\n          dialogClose={dialogClose}\n          dialogConfrim={dialogConfrim}\n          type={addOrEdit}\n          editId={editId}\n        ></AddOrEditDialog>\n      )}\n    </LabelWrapper>\n  )\n})\n\nexport default Label\n"],"names":["getLabelList","data","requestJson","request","method","url","deleteLabelById","id","concat","getProductById","addLabel","editProduct","uploadProductBanner","requestMultipart","deleteImgByName","getProductList","addProduct","deleteProductById","getTableScroll","extraHeight","arguments","length","undefined","tHeader","document","getElementById","getElementsByClassName","tHeaderBottom","getBoundingClientRect","bottom","LabelWrapper","styled","div","_templateObject","_taggedTemplateLiteral","handleDelete","handleEdit","title","dataIndex","align","key","render","_jsx","Image","width","height","src","text","record","_jsxs","Space","size","children","Button","type","onClick","Popconfirm","description","onConfirm","e","confirm","okText","cancelText","AddOrEditDialogWrapper","props","setPath","onChange","imgList","maxCount","previewOpen","setPreviewOpen","useState","previewImage","setPreviewImage","previewTitle","setPreviewTitle","fileList","setFileList","useEffect","uploadButton","PlusOutlined","style","marginTop","_Fragment","Upload","listType","onPreview","async","file","preview","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","error","getBase64","originFileObj","name","substring","lastIndexOf","_ref","console","log","onRemove","beforeUpload","handleBeforeUpload","Modal","open","footer","onCancel","handleCancel","alt","AddOrEditDialog","memo","editId","dialogClose","dialogConfrim","form","Form","useForm","iconPath","setIconPath","iconFileList","setIconFileList","handleUploadImage","formData","FormData","files","forEach","itme","append","http","code","_data$icon","setFieldsValue","list","icon","split","map","item","fetchData","onOk","submit","autoComplete","labelCol","span","onFinish","v","paths","join","changePath","originPath","path","changeList","filter","originList","getImgPath","Item","label","validateTrigger","rules","required","message","Input","placeholder","YmUpload","defaultProps","tableData","setTableData","visible","setVisible","loading","setLoading","addOrEdit","setAddOrEdit","setEditId","scrollY","setScrollY","fetchList","useCallback","payload","window","$msg","success","className","showDialog","Table","bordered","columns","getColumns","_ref2","dataSource","pagination","scroll","y"],"sourceRoot":""}